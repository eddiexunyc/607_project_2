---
title: "607_project_2"
author: "Eddie Xu"
date: "2023-03-04"
output: html_document
---
## Project 2 - Tidying Up Data for Downstream Analysis
The goal of this assignment is to give you practice in preparing different datasets for downstream
analysis work

## Load Packages
```{r}
library(tidyverse)
```

## Load Datasets from different sources to seperate dataframes
```{r}
# From Nick Climaco's NAFTA country population
country_url <- ("https://raw.githubusercontent.com/Nick-Climaco/Rdataset/main/nafta_countries.csv")
country_file <- data.frame(read.csv(country_url, header = TRUE))

# From Genesis Middleton county GDP data
county_url <-("https://raw.githubusercontent.com/eddiexunyc/607_project_2/main/Resources/gdp_by_county.csv")
county_file <- data.frame(read.csv(county_url, header = TRUE))

# Interest Rate Data
interest_rate_url <- ("https://raw.githubusercontent.com/eddiexunyc/607_project_2/main/Resources/interest_rate.csv")
interest_file <- data.frame(read.csv(interest_rate_url, header = TRUE, sep = ";"))
```

## View all datasets
```{r}
# view the country dataframe
head(country_file)
```

```{r}
# view the county GDP dataframe
head(county_file)
```

```{r}
# view the interest rate dataframe
head(interest_file)
```

## Data Cleaning on NAFTA Population Data
```{r}
# rename the column 
colnames(country_file) <- c("ID", "Country", "1994", "1995", "1996", "1997", "1998", "1999", "2000")

# pivot longer the year and population
country_tidy_df <- country_file %>%
  pivot_longer(c("1994", "1995", "1996", "1997", "1998", "1999", "2000"), names_to = "Year", values_to = "Population")

knitr::kable(country_tidy_df)
```

## Data Analysis on NAFTA Population Data
```{r}
# change the class of Year to numeric
country_tidy_df$Year <- as.integer(country_tidy_df$Year)

# calculate the population difference and rate of change
growth_rate <- country_tidy_df %>%
  group_by(Country) %>%
  arrange(Year) %>%
  mutate(pop_difference = Population - lag(Population),
         rate_percent = round((pop_difference/lag(Population)) * 100, digits = 2))

# rename the column
colnames(growth_rate) <- c("ID", "Country", "Year", "Population", "Population Difference", "Population % Change")

knitr::kable(growth_rate)
```

```{r}
# graph a line chart of rate change in population
growth_bar <- ggplot(data = subset(growth_rate, !is.na(`Population % Change`)), aes(x = Year, y = `Population % Change`, fill = `Country`)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = `Population % Change`), position = position_dodge(0.9), color = "black", vjust = 1, hjust = 0.5)

growth_bar
```

## Data Cleaning on County GDP Data
```{r}
# remove first 2 rows
county_tidy_df <- county_file[-(1:2),]

# remove last 3 rows
county_tidy_df <- county_tidy_df[-(12454:12458),]

# rename the column
colnames(county_tidy_df) <- c("FIPS", "County Name", "State", "Line Code", "Industry Name", "GDP in 2012 (thousands of dollars)", "GDP in 2013 (thousands of dollars)", "GDP in 2014 (thousands of dollars)", "GDP in 2015 (thousands of dollars)")

knitr::kable(county_tidy_df)
```















